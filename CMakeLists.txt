# Call find_package() on a dummy package to satisfy cmake-conan even if the project has no dependencies
find_package(__CONAN_DUMMY__ QUIET)

# Copy shared formatter/linter config files to the project root
configure_file(${CMAKE_CURRENT_LIST_DIR}/.clang-format ${CMAKE_SOURCE_DIR}/.clang-format COPYONLY)
configure_file(${CMAKE_CURRENT_LIST_DIR}/.clang-tidy ${CMAKE_SOURCE_DIR}/.clang-tidy COPYONLY)
configure_file(${CMAKE_CURRENT_LIST_DIR}/.cmake-format.py ${CMAKE_SOURCE_DIR}/.cmake-format.py
               COPYONLY)

# Warn if .gitignore doesn't ignore the copied config files
set(gitignore_path "${CMAKE_SOURCE_DIR}/.gitignore")
if(EXISTS "${gitignore_path}")
    file(READ "${gitignore_path}" gitignore_contents)
    foreach(file IN ITEMS .clang-format .clang-tidy .cmake-format.py)
        string(FIND "${gitignore_contents}" "${file}" pos)
        if(pos EQUAL -1)
            message(WARNING "${file} is not listed in ${gitignore_path}. "
                            "This file is auto-generated by project-config and should be ignored.")
        endif()
    endforeach()
endif()
